---
title: 'Modelización de datos de entrada'
author: "Juan Diego M. Flores"
date: "16 de enero de 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(e1071)
```
## Enunciado

Determinar la distribución de la cantidad de precipitación 
diaria en una localidad geográfica. Como los patrones climáticos varian mes a mes,
los diferentes meses pueden tener diferentes distribuciones de probabilidad.
En particular, los datos de este ejercicio corresponden a la localidad de Gavidia,
en el páramo merideño durante los años 2000 a 2004. Los datos ya han sido procesados
y se encuentren en un data frame con dos columnas M (mes) y P (precipitación).

### Carga de Datos

```{r carga de datos}
datos <-load("PreMensual.RData")
```

Trabajaremos con los datos del mes de Mayo(5), por lo tanto seleccionamos dicho mes.

```{r}
mayo_d <- byMonth %>%
    filter(M==5)
head(mayo_d)

```

Aislamos solo la variable de precipitacion y obtenemos:

```{r}
mayo <- mayo_d$P
mayo
```

### Verificación de la independencia de los datos

##### Gráfico de Autocorrelación:

La primera técnica y la más explicita es el gráfico de autocorrelación
```{r}
acf(mayo)
```

De acuerdo a este gráfico se logro ver que no se muestra correlacion significativa para los retardos, esto representa
un fuerte indicio de que las observaciones son independientes entre sí. Es decir los datos no parecen estar correlacionados serialmente.
Sin embargo veremos que nos dicen las demas técnicas disponibles

##### Gráfico de las observaciones a lo largo del tiempo

Otra técnica es graficar las observaciones a lo largo del tiempo, esto nos Mostrará si las observaciones muestran tendencias obvias.

```{r autocor2}
ts.plot(mayo)
```

El gráfico a lo largo del tiempo no parece mostrar tendencias obvias otro claro indicio de que los datos son independientes.

##### Gráficos de Dispersión

la Última técnica a utilizar serán los gráficos de dispersión para observar las formas descritas por las observaciones, en este caso lo realizamos para 4 separaciones.

```{r}
lag.plot(mayo,lags=4,layout=c(2,2),labels=F,do.lines=F)
```

De nuevo y en concordancia con las gráficas anteriores no vemos correlación en los datos.

###### Análisis 

De acuerdo con las gráficas anteriores y en especial con el gráfico de correlación se concluye que los datos son independientes.


###  Formulación de una distribución probable

#####  Histograma de Probabilidad

El histograma nos dará un idea de la forma de la distribución.

```{r hipotesis 1}
hist(mayo,prob=T)
```

De acuerdo con el histograma presentado, notamos que los datos parecen seguir la forma de una distribución Exponencial, sin embargo utilizaremos las estadísticas sobre los datos ya que algunas distribuciones se caracterizan al menos parcialmente por funciones de sus parámetros 

##### Resumen de estadísticas
```{r hipotesis 2}
summary(mayo)
```

##### Varianza
```{r hipotesis 3}
var(mayo)
```

##### Coeficiente de variación
```{r hipotesis 4}
cvar = sd(mayo)/mean(mayo)
cvar
```

##### Sesgo
```{r hipotesis 5}
skewness(mayo)
```

Tanto el Coeficiente de variación (cv ~ 1) y el sesgo (v > 0) siguen la hipótesis formulada a partir de la forma del histograma, los datos parecen seguir una distribución Exponencial. 


### Cálculo de los parámetros para la distribución candidata.

Calculamos el parámetro para la distribucion candidata: Exponencial.
```{r}
library(MASS)
lambda =fitdistr(mayo,"exponential")
lambda
```

### Comparación Gráfica

Comparemos graficamente la función de probabilidad acumulada de la distribución con la función de probabilidad empírica de los datos:

### Indicaciones:

1. Algunas referencias interesantes para este tema y el proyecto

  + Gráfico con las distribuciones de probabilidad y sus relaciones https://www.johndcook.com/blog/distribution_chart/
  
  + Grafico de selección de las distribuciones: 
  ![](seleccionDistribuciones.png)
  
Fuente: http://people.stern.nyu.edu/adamodar/pdfiles/papers/probabilistic.pdf

2. Distribuciones comunes para modelizar datos de precipitacion son:

  + La exponencial

  + La Gamma

  + La Weibull

  + La Logonormal

Asi que estas deben ser sus principales "sospechosas".

 